<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <data>
    <record id="view_kpi_unified_form" model="ir.ui.view">
      <field name="name">kpi.unified.form</field>
      <field name="model">kpi.unified</field>
      <field name="arch" type="xml">
        <form string="KPI (Unified)" create="0" delete="0" edit="0">
          <header>
            <button name="action_open_source" type="object" class="btn-primary" string="Open Source"/>
          </header>
          <sheet>
            <group>
              <field name="kind"/>
              <field name="name"/>
              <field name="achievement_percentage"/>
              <field name="status"/>
              <field name="programme_id"/>
              <field name="kra_id"/>
              <field name="directorate_id"/>
              <field name="division_id"/>
              <field name="start_date"/>
              <field name="end_date"/>
              <field name="measurement_unit"/>
              <field name="target_value"/>
              <field name="current_value"/>
              <field name="source_model"/>
              <field name="source_id"/>
            </group>
          </sheet>
        </form>
      </field>
    </record>
    <record id="view_kpi_unified_list" model="ir.ui.view">
      <field name="name">kpi.unified.list</field>
      <field name="model">kpi.unified</field>
      <field name="arch" type="xml">
        <list string="All KPIs" create="0" delete="0">
          <field name="kind"/>
          <field name="name"/>
          <field name="achievement_percentage"/>
          <field name="status"/>
          <field name="programme_id"/>
          <field name="kra_id"/>
          <field name="directorate_id"/>
          <field name="division_id"/>
          <field name="start_date"/>
          <field name="end_date"/>
        </list>
      </field>
    </record>

    <record id="view_kpi_unified_search" model="ir.ui.view">
      <field name="name">kpi.unified.search</field>
      <field name="model">kpi.unified</field>
      <field name="arch" type="xml">
        <search string="Search KPIs">
          <field name="name" string="Name" filter_domain="[('name','ilike', self)]"/>
          <filter string="Strategic" name="f_strategic" domain="[('kind','=','strategic')]"/>
          <filter string="Programme" name="f_programme" domain="[('kind','=','programme')]"/>
          <filter string="Excellent (≥90%)" name="f_exc" domain="[('achievement_percentage','>=',90)]"/>
          <filter string="Good (70–89%)" name="f_good" domain="[('achievement_percentage','>=',70),('achievement_percentage','&lt;',90)]"/>
          <filter string="Fair (50–69%)" name="f_fair" domain="[('achievement_percentage','>=',50),('achievement_percentage','&lt;',70)]"/>
          <filter string="Poor (&lt;50%)" name="f_poor" domain="[('achievement_percentage','&lt;',50)]"/>
          <group expand="0" string="Group By">
            <filter string="Type" name="group_by_kind" context="{'group_by':'kind'}"/>
            <filter string="Programme" name="group_by_programme" context="{'group_by':'programme_id'}"/>
            <filter string="Directorate" name="group_by_directorate" context="{'group_by':'directorate_id'}"/>
            <filter string="Division" name="group_by_division" context="{'group_by':'division_id'}"/>
          </group>
        </search>
      </field>
    </record>

    <record id="action_kpi_unified" model="ir.actions.act_window">
      <field name="name">All KPIs</field>
  <field name="res_model">kpi.unified</field>
  <field name="view_mode">list,form</field>
      <field name="search_view_id" ref="view_kpi_unified_search"/>
      <field name="context">{"search_default_f_strategic": 0, "search_default_f_programme": 0}</field>
      <field name="help" type="html">
        <p class="o_view_nocontent_smiling_face">Unified listing of Strategic KPIs and Programme Indicators.</p>
        <p>Open any row to navigate to its source record.</p>
      </field>
    </record>
  </data>
</odoo>
